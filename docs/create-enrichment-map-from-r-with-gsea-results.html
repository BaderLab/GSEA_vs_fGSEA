<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Create Enrichment map from R with GSEA results | CBW pathways Workshops - example R notebooks</title>
  <meta name="description" content="These are example R Notebooks to run g:profiler and GSEA and visualize results in Cytoscape with Enrichment map directly from R" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Create Enrichment map from R with GSEA results | CBW pathways Workshops - example R notebooks" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.png" />
  <meta property="og:description" content="These are example R Notebooks to run g:profiler and GSEA and visualize results in Cytoscape with Enrichment map directly from R" />
  <meta name="github-repo" content="risserlin/CBW_pathways_workshop_R_notebooks" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Create Enrichment map from R with GSEA results | CBW pathways Workshops - example R notebooks" />
  
  <meta name="twitter:description" content="These are example R Notebooks to run g:profiler and GSEA and visualize results in Cytoscape with Enrichment map directly from R" />
  <meta name="twitter:image" content="/images/cover.png" />

<meta name="author" content="Ruth Isserlin" />


<meta name="date" content="2023-05-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="create-enrichment-map-from-r-with-gprofiler-results.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://bioinformatics.ca/workshops/current-workshops/"><img src="./images/bioinfologo.png" width="280"></a><a href="./">CBW Workshop R Notebooks</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Index</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> CBW Workshop example R Notebooks</a></li>
<li class="chapter" data-level="3" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>3</b> Setup</a>
<ul>
<li class="chapter" data-level="3.1" data-path="setup.html"><a href="setup.html#install-r-and-rstudio"><i class="fa fa-check"></i><b>3.1</b> Install R and RStudio</a></li>
<li class="chapter" data-level="3.2" data-path="setup.html"><a href="setup.html#docker-optional"><i class="fa fa-check"></i><b>3.2</b> Docker [Optional]</a></li>
<li class="chapter" data-level="3.3" data-path="setup.html"><a href="setup.html#install-docker"><i class="fa fa-check"></i><b>3.3</b> Install Docker</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="setup.html"><a href="setup.html#windows"><i class="fa fa-check"></i><b>3.3.1</b> Windows</a></li>
<li class="chapter" data-level="3.3.2" data-path="setup.html"><a href="setup.html#macos-linux"><i class="fa fa-check"></i><b>3.3.2</b> MacOS / Linux</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="run-gprofiler-from-r.html"><a href="run-gprofiler-from-r.html"><i class="fa fa-check"></i><b>4</b> Run g:profiler from R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="run-gprofiler-from-r.html"><a href="run-gprofiler-from-r.html#initialize-variables-and-libraries"><i class="fa fa-check"></i><b>4.1</b> Initialize variables and libraries</a></li>
<li class="chapter" data-level="4.2" data-path="run-gprofiler-from-r.html"><a href="run-gprofiler-from-r.html#load-in-query-set"><i class="fa fa-check"></i><b>4.2</b> Load in Query set</a></li>
<li class="chapter" data-level="4.3" data-path="run-gprofiler-from-r.html"><a href="run-gprofiler-from-r.html#run-gprofiler-with-supplied-genesets"><i class="fa fa-check"></i><b>4.3</b> Run g:profiler with supplied genesets</a></li>
<li class="chapter" data-level="4.4" data-path="run-gprofiler-from-r.html"><a href="run-gprofiler-from-r.html#download-and-load-gprofiler-geneset-file"><i class="fa fa-check"></i><b>4.4</b> Download and load g:profiler geneset file</a></li>
<li class="chapter" data-level="4.5" data-path="run-gprofiler-from-r.html"><a href="run-gprofiler-from-r.html#filter-results-by-geneset-size"><i class="fa fa-check"></i><b>4.5</b> Filter results by geneset size</a></li>
<li class="chapter" data-level="4.6" data-path="run-gprofiler-from-r.html"><a href="run-gprofiler-from-r.html#create-an-output-file-of-the-results---generic-enrichment-map-file-from-gprofiler-gmt"><i class="fa fa-check"></i><b>4.6</b> Create an output file of the results - Generic enrichment Map file from g:profiler gmt</a></li>
<li class="chapter" data-level="4.7" data-path="run-gprofiler-from-r.html"><a href="run-gprofiler-from-r.html#run-gprofiler-with-your-own-genesets-example-using-baderlab-genesets"><i class="fa fa-check"></i><b>4.7</b> Run g:profiler with your own genesets (example using BaderLab genesets)</a></li>
<li class="chapter" data-level="4.8" data-path="run-gprofiler-from-r.html"><a href="run-gprofiler-from-r.html#download-and-load-bader-lab-geneset-file"><i class="fa fa-check"></i><b>4.8</b> Download and load Bader lab geneset file</a></li>
<li class="chapter" data-level="4.9" data-path="run-gprofiler-from-r.html"><a href="run-gprofiler-from-r.html#filter-bader-lab-geneset-file"><i class="fa fa-check"></i><b>4.9</b> Filter Bader lab geneset file</a></li>
<li class="chapter" data-level="4.10" data-path="run-gprofiler-from-r.html"><a href="run-gprofiler-from-r.html#upload-the-gmt-files-to-gprofiler"><i class="fa fa-check"></i><b>4.10</b> Upload the gmt files to gprofiler</a></li>
<li class="chapter" data-level="4.11" data-path="run-gprofiler-from-r.html"><a href="run-gprofiler-from-r.html#create-an-output-file-of-the-results---generic-enrichment-map-file-from-baderlab-gmt"><i class="fa fa-check"></i><b>4.11</b> Create an output file of the results - Generic enrichment Map file from Baderlab gmt</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="run-gsea-from-within-r.html"><a href="run-gsea-from-within-r.html"><i class="fa fa-check"></i><b>5</b> Run GSEA from within R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="run-gsea-from-within-r.html"><a href="run-gsea-from-within-r.html#load-in-required-libraries"><i class="fa fa-check"></i><b>5.1</b> Load in required libraries</a></li>
<li class="chapter" data-level="5.2" data-path="run-gsea-from-within-r.html"><a href="run-gsea-from-within-r.html#configurable-parameters"><i class="fa fa-check"></i><b>5.2</b> Configurable Parameters</a></li>
<li class="chapter" data-level="5.3" data-path="run-gsea-from-within-r.html"><a href="run-gsea-from-within-r.html#download-the-latest-pathway-definition-file"><i class="fa fa-check"></i><b>5.3</b> Download the latest pathway definition file</a></li>
<li class="chapter" data-level="5.4" data-path="run-gsea-from-within-r.html"><a href="run-gsea-from-within-r.html#run-gsea"><i class="fa fa-check"></i><b>5.4</b> Run GSEA</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="create-gmt-file-from-ensembl.html"><a href="create-gmt-file-from-ensembl.html"><i class="fa fa-check"></i><b>6</b> Create GMT file from Ensembl</a>
<ul>
<li class="chapter" data-level="6.1" data-path="create-gmt-file-from-ensembl.html"><a href="create-gmt-file-from-ensembl.html#load-libraries"><i class="fa fa-check"></i><b>6.1</b> Load Libraries</a></li>
<li class="chapter" data-level="6.2" data-path="create-gmt-file-from-ensembl.html"><a href="create-gmt-file-from-ensembl.html#set-up-biomart-connection"><i class="fa fa-check"></i><b>6.2</b> Set up Biomart connection</a></li>
<li class="chapter" data-level="6.3" data-path="create-gmt-file-from-ensembl.html"><a href="create-gmt-file-from-ensembl.html#get-species-go-annotations"><i class="fa fa-check"></i><b>6.3</b> Get species GO annotations</a></li>
<li class="chapter" data-level="6.4" data-path="create-gmt-file-from-ensembl.html"><a href="create-gmt-file-from-ensembl.html#format-results-into-gmt-file"><i class="fa fa-check"></i><b>6.4</b> Format results into GMT file</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="create-enrichment-map-from-r-with-gprofiler-results.html"><a href="create-enrichment-map-from-r-with-gprofiler-results.html"><i class="fa fa-check"></i><b>7</b> Create Enrichment map from R with g:Profiler results</a>
<ul>
<li class="chapter" data-level="7.1" data-path="create-enrichment-map-from-r-with-gprofiler-results.html"><a href="create-enrichment-map-from-r-with-gprofiler-results.html#initialize-variables-and-libraries-1"><i class="fa fa-check"></i><b>7.1</b> Initialize variables and libraries</a></li>
<li class="chapter" data-level="7.2" data-path="create-enrichment-map-from-r-with-gprofiler-results.html"><a href="create-enrichment-map-from-r-with-gprofiler-results.html#configurable-parameters-1"><i class="fa fa-check"></i><b>7.2</b> Configurable Parameters</a></li>
<li class="chapter" data-level="7.3" data-path="create-enrichment-map-from-r-with-gprofiler-results.html"><a href="create-enrichment-map-from-r-with-gprofiler-results.html#specify-data-files"><i class="fa fa-check"></i><b>7.3</b> Specify Data files</a></li>
<li class="chapter" data-level="7.4" data-path="create-enrichment-map-from-r-with-gprofiler-results.html"><a href="create-enrichment-map-from-r-with-gprofiler-results.html#launch-cytoscape"><i class="fa fa-check"></i><b>7.4</b> Launch Cytoscape</a></li>
<li class="chapter" data-level="7.5" data-path="create-enrichment-map-from-r-with-gprofiler-results.html"><a href="create-enrichment-map-from-r-with-gprofiler-results.html#make-sure-you-can-connect-to-cytoscape"><i class="fa fa-check"></i><b>7.5</b> Make sure you can connect to Cytoscape</a></li>
<li class="chapter" data-level="7.6" data-path="create-enrichment-map-from-r-with-gprofiler-results.html"><a href="create-enrichment-map-from-r-with-gprofiler-results.html#create-an-enrichment-map"><i class="fa fa-check"></i><b>7.6</b> Create an Enrichment map</a></li>
<li class="chapter" data-level="7.7" data-path="create-enrichment-map-from-r-with-gprofiler-results.html"><a href="create-enrichment-map-from-r-with-gprofiler-results.html#create-an-enrichment-map---run-em-command"><i class="fa fa-check"></i><b>7.7</b> Create an Enrichment map - run EM command</a></li>
<li class="chapter" data-level="7.8" data-path="create-enrichment-map-from-r-with-gprofiler-results.html"><a href="create-enrichment-map-from-r-with-gprofiler-results.html#get-a-screen-shot-of-the-initial-network."><i class="fa fa-check"></i><b>7.8</b> Get a screen shot of the initial network.</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="create-enrichment-map-from-r-with-gsea-results.html"><a href="create-enrichment-map-from-r-with-gsea-results.html"><i class="fa fa-check"></i><b>8</b> Create Enrichment map from R with GSEA results</a>
<ul>
<li class="chapter" data-level="8.1" data-path="create-enrichment-map-from-r-with-gsea-results.html"><a href="create-enrichment-map-from-r-with-gsea-results.html#initialize-variables-and-libraries-2"><i class="fa fa-check"></i><b>8.1</b> Initialize variables and libraries</a></li>
<li class="chapter" data-level="8.2" data-path="create-enrichment-map-from-r-with-gsea-results.html"><a href="create-enrichment-map-from-r-with-gsea-results.html#configurable-parameters-2"><i class="fa fa-check"></i><b>8.2</b> Configurable Parameters</a></li>
<li class="chapter" data-level="8.3" data-path="create-enrichment-map-from-r-with-gsea-results.html"><a href="create-enrichment-map-from-r-with-gsea-results.html#specify-data-files-1"><i class="fa fa-check"></i><b>8.3</b> Specify Data files</a></li>
<li class="chapter" data-level="8.4" data-path="create-enrichment-map-from-r-with-gsea-results.html"><a href="create-enrichment-map-from-r-with-gsea-results.html#optional-file-specification"><i class="fa fa-check"></i><b>8.4</b> Optional File specification</a></li>
<li class="chapter" data-level="8.5" data-path="create-enrichment-map-from-r-with-gsea-results.html"><a href="create-enrichment-map-from-r-with-gsea-results.html#launch-cytoscape-1"><i class="fa fa-check"></i><b>8.5</b> Launch Cytoscape</a></li>
<li class="chapter" data-level="8.6" data-path="create-enrichment-map-from-r-with-gsea-results.html"><a href="create-enrichment-map-from-r-with-gsea-results.html#make-sure-you-can-connect-to-cytoscape-1"><i class="fa fa-check"></i><b>8.6</b> Make sure you can connect to Cytoscape</a></li>
<li class="chapter" data-level="8.7" data-path="create-enrichment-map-from-r-with-gsea-results.html"><a href="create-enrichment-map-from-r-with-gsea-results.html#create-an-enrichment-map-1"><i class="fa fa-check"></i><b>8.7</b> Create an Enrichment map</a></li>
<li class="chapter" data-level="8.8" data-path="create-enrichment-map-from-r-with-gsea-results.html"><a href="create-enrichment-map-from-r-with-gsea-results.html#create-an-enrichment-map---run-em-command-1"><i class="fa fa-check"></i><b>8.8</b> Create an Enrichment map - run EM command</a></li>
<li class="chapter" data-level="8.9" data-path="create-enrichment-map-from-r-with-gsea-results.html"><a href="create-enrichment-map-from-r-with-gsea-results.html#get-a-screen-shot-of-the-initial-network.-1"><i class="fa fa-check"></i><b>8.9</b> Get a screen shot of the initial network.</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
<li class="divider"></li>
<li><a href="https://baderlab.org" target="blank"><img src="./images/baderlablogo.png" width="280">Bader Lab</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CBW pathways Workshops - example R notebooks</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="create-enrichment-map-from-r-with-gsea-results" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Create Enrichment map from R with GSEA results<a href="create-enrichment-map-from-r-with-gsea-results.html#create-enrichment-map-from-r-with-gsea-results" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="initialize-variables-and-libraries-2" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Initialize variables and libraries<a href="create-enrichment-map-from-r-with-gsea-results.html#initialize-variables-and-libraries-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#use library</span></span>
<span id="cb78-2"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co">#make sure biocManager is installed</span></span>
<span id="cb78-3"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatch</span>(<span class="at">expr =</span> { <span class="fu">library</span>(<span class="st">&quot;BiocManager&quot;</span>)}, </span>
<span id="cb78-4"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb78-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">error =</span> <span class="cf">function</span>(e) { </span>
<span id="cb78-5"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb78-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">install.packages</span>(<span class="st">&quot;BiocManager&quot;</span>)}, </span>
<span id="cb78-6"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb78-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">finally =</span> <span class="fu">library</span>(<span class="st">&quot;BiocManager&quot;</span>))</span></code></pre></div>
<pre><code>## Bioconductor version &#39;3.16&#39; is out-of-date; the current release version &#39;3.17&#39;
##   is available with R version &#39;4.3&#39;; see https://bioconductor.org/install</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatch</span>(<span class="at">expr =</span> { <span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)}, </span>
<span id="cb80-2"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb80-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">error =</span> <span class="cf">function</span>(e) { <span class="fu">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)}, </span>
<span id="cb80-3"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb80-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">finally =</span> <span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>))</span>
<span id="cb80-4"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co">#use easy cyRest library to communicate with cytoscape.</span></span>
<span id="cb80-6"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatch</span>(<span class="at">expr =</span> { <span class="fu">library</span>(<span class="st">&quot;RCy3&quot;</span>)}, </span>
<span id="cb80-7"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb80-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">error =</span> <span class="cf">function</span>(e) { BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">&quot;RCy3&quot;</span>)}, </span>
<span id="cb80-8"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb80-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">finally =</span> <span class="fu">library</span>(<span class="st">&quot;RCy3&quot;</span>))</span>
<span id="cb80-9"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatch</span>(<span class="at">expr =</span> { <span class="fu">library</span>(<span class="st">&quot;httr&quot;</span>)}, </span>
<span id="cb80-11"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb80-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">error =</span> <span class="cf">function</span>(e) { BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">&quot;httr&quot;</span>)}, </span>
<span id="cb80-12"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb80-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">finally =</span> <span class="fu">library</span>(<span class="st">&quot;httr&quot;</span>))</span></code></pre></div>
</div>
<div id="configurable-parameters-2" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Configurable Parameters<a href="create-enrichment-map-from-r-with-gsea-results.html#configurable-parameters-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># is_docker - true/false depending on if you are running R from docker</span></span>
<span id="cb81-2"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-2" aria-hidden="true" tabindex="-1"></a>is_docker <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb81-3"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co">#directory where all the original input data file are</span></span>
<span id="cb81-5"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for example ./data/</span></span>
<span id="cb81-6"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-6" aria-hidden="true" tabindex="-1"></a>working_dir <span class="ot">&lt;-</span> <span class="st">&quot;./data/&quot;</span></span>
<span id="cb81-7"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="co">#directory where all the generated data files are found.</span></span>
<span id="cb81-10"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="co"># For example - ./generated_data/</span></span>
<span id="cb81-11"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="co"># If you are using all the notebooks from this set the generated data will be</span></span>
<span id="cb81-12"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="co"># put in the ./generated_data folder.  You have to specify if it is gsea or </span></span>
<span id="cb81-13"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="co"># gprofiler</span></span>
<span id="cb81-14"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-14" aria-hidden="true" tabindex="-1"></a>output_dir <span class="ot">&lt;-</span> <span class="st">&quot;./generated_data/gsea/&quot;</span></span>
<span id="cb81-15"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-16"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-17"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="co">#defined threshold for GSEA enrichments </span></span>
<span id="cb81-18"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-18" aria-hidden="true" tabindex="-1"></a><span class="co">#p-value to filter all the genesets.  For example -   1.0</span></span>
<span id="cb81-19"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-19" aria-hidden="true" tabindex="-1"></a>pvalue_gsea_threshold <span class="ot">&lt;-</span> <span class="fl">1.0</span></span>
<span id="cb81-20"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-21"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-21" aria-hidden="true" tabindex="-1"></a><span class="co">#q-value to filter all the genesets.  For example -   0.05</span></span>
<span id="cb81-22"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-22" aria-hidden="true" tabindex="-1"></a>qvalue_gsea_threshold <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb81-23"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-24"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-24" aria-hidden="true" tabindex="-1"></a><span class="co">#similarity threshold to filter all the genesets connections/edges.  </span></span>
<span id="cb81-25"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-25" aria-hidden="true" tabindex="-1"></a><span class="co"># For example -   0.375</span></span>
<span id="cb81-26"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-26" aria-hidden="true" tabindex="-1"></a>similarity_threshold <span class="ot">&lt;-</span> <span class="st">&quot;0.375&quot;</span></span>
<span id="cb81-27"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-28"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-28" aria-hidden="true" tabindex="-1"></a><span class="co">#similarity metric to filter all the genesets connections/edges </span></span>
<span id="cb81-29"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-29" aria-hidden="true" tabindex="-1"></a><span class="co"># (can be OVERLAP, JACCARD, or COMBINED.   For example -   Combined</span></span>
<span id="cb81-30"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb81-30" aria-hidden="true" tabindex="-1"></a>similarity_metric <span class="ot">=</span> <span class="st">&quot;COMBINED&quot;</span></span></code></pre></div>
</div>
<div id="specify-data-files-1" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Specify Data files<a href="create-enrichment-map-from-r-with-gsea-results.html#specify-data-files-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Depending on whether you are creating your enrichment map from g:Profiler or GSEA results the sets of files might be a little different. Minimally, you will need to specify:
* gmt file
* enrichment results file</p>
<p>Although there is a gmt file in the gsea edb results directory(which is the easiest method to create an enrichment map) it have been filtered to contain only genes represented in the expression set. If you use this fltered file you will get different pathway connectivity depending on the dataset being used. We recommend using original gmt file used for the gsea analysis and not the filtered one in the results directory.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#use the newest gmt file in the output directory</span></span>
<span id="cb82-2"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb82-2" aria-hidden="true" tabindex="-1"></a>gmt_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> output_dir, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.gmt&quot;</span>)</span>
<span id="cb82-3"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#get the details on the files</span></span>
<span id="cb82-5"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb82-5" aria-hidden="true" tabindex="-1"></a>  details <span class="ot">=</span> <span class="fu">file.info</span>(<span class="fu">file.path</span>(output_dir,gmt_files))</span>
<span id="cb82-6"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#order according to newest to oldest</span></span>
<span id="cb82-7"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb82-7" aria-hidden="true" tabindex="-1"></a>  details <span class="ot">=</span> details[<span class="fu">with</span>(details, <span class="fu">order</span>(<span class="fu">as.POSIXct</span>(mtime),<span class="at">decreasing =</span> <span class="cn">TRUE</span>)), ]</span>
<span id="cb82-8"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb82-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-9"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#use the newest file:</span></span>
<span id="cb82-10"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb82-10" aria-hidden="true" tabindex="-1"></a> gmt_gsea_file <span class="ot">&lt;-</span> <span class="fu">row.names</span>(details)[<span class="dv">1</span>]</span></code></pre></div>
<p>GSEA output directory - You can specify the exact name of the directory. The below code looks for the newest GSEA results directory and uses that.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb83-1" aria-hidden="true" tabindex="-1"></a>gsea_directories <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> output_dir, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.GseaPreranked&quot;</span>)</span>
<span id="cb83-2"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co">#get the details on the files</span></span>
<span id="cb83-4"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb83-4" aria-hidden="true" tabindex="-1"></a>details <span class="ot">=</span> <span class="fu">file.info</span>(<span class="fu">file.path</span>(output_dir,gsea_directories))</span>
<span id="cb83-5"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co">#order according to newest to oldest</span></span>
<span id="cb83-6"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb83-6" aria-hidden="true" tabindex="-1"></a>details <span class="ot">=</span> details[<span class="fu">with</span>(details, <span class="fu">order</span>(<span class="fu">as.POSIXct</span>(mtime),<span class="at">decreasing =</span> <span class="cn">TRUE</span>)), ]</span>
<span id="cb83-7"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb83-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="co">#use the newest file:</span></span>
<span id="cb83-9"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb83-9" aria-hidden="true" tabindex="-1"></a>gsea_output_dir <span class="ot">&lt;-</span> <span class="fu">row.names</span>(details)[<span class="dv">1</span>]</span>
<span id="cb83-10"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb83-11" aria-hidden="true" tabindex="-1"></a>gsea_results_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(gsea_output_dir,<span class="st">&quot;edb&quot;</span>)</span>
<span id="cb83-12"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb83-12" aria-hidden="true" tabindex="-1"></a>gsea_results_filename <span class="ot">&lt;-</span> <span class="fu">file.path</span>(gsea_results_path,<span class="st">&quot;results.edb&quot;</span>)</span></code></pre></div>
</div>
<div id="optional-file-specification" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Optional File specification<a href="create-enrichment-map-from-r-with-gsea-results.html#optional-file-specification" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>These files are not needed to create the enrichment map but are very beneficial when analyzing your result.<br />
* gene expression file
* gene ranks file</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb84-1" aria-hidden="true" tabindex="-1"></a>gsea_ranks_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(gsea_results_path,</span>
<span id="cb84-2"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb84-2" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">list.files</span>(gsea_results_path,<span class="at">pattern=</span><span class="st">&quot;.rnk&quot;</span>))</span>
<span id="cb84-3"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb84-4" aria-hidden="true" tabindex="-1"></a>expression_file_fullpath <span class="ot">&lt;-</span> <span class="fu">file.path</span>(working_dir,</span>
<span id="cb84-5"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb84-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;MesenchymalvsImmunoreactive_rnaseq_expression.txt&quot;</span>)</span>
<span id="cb84-6"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="co">#define an analysis name</span></span>
<span id="cb84-8"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb84-8" aria-hidden="true" tabindex="-1"></a>cur_model_name <span class="ot">&lt;-</span> <span class="st">&quot;Mesen_vs_Immuno_buildfromR&quot;</span></span></code></pre></div>
</div>
<div id="launch-cytoscape-1" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Launch Cytoscape<a href="create-enrichment-map-from-r-with-gsea-results.html#launch-cytoscape-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Launch Cytoscape (by default cytoscape will automatically enable rest so as long as cytoscape 3.3 or higher is open R should be able to communicate with it). Make sure if you get an message asking you if you want communicate with other apps that you select “Allow”.</p>
</div>
<div id="make-sure-you-can-connect-to-cytoscape-1" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Make sure you can connect to Cytoscape<a href="create-enrichment-map-from-r-with-gsea-results.html#make-sure-you-can-connect-to-cytoscape-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(is_docker){</span>
<span id="cb85-2"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb85-2" aria-hidden="true" tabindex="-1"></a>  current_base <span class="ot">=</span> <span class="st">&quot;host.docker.internal:1234/v1&quot;</span></span>
<span id="cb85-3"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb85-3" aria-hidden="true" tabindex="-1"></a>  .defaultBaseUrl <span class="ot">&lt;-</span> <span class="st">&quot;http://host.docker.internal:1234/v1&quot;</span></span>
<span id="cb85-4"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb85-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span>{</span>
<span id="cb85-5"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb85-5" aria-hidden="true" tabindex="-1"></a>  current_base <span class="ot">=</span> <span class="st">&quot;localhost:1234/v1&quot;</span></span>
<span id="cb85-6"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb85-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-7"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cytoscapePing</span> (<span class="at">base.url =</span> current_base)</span></code></pre></div>
<pre><code>## You are connected to Cytoscape!</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cytoscapeVersionInfo</span> (<span class="at">base.url =</span> current_base)</span></code></pre></div>
<pre><code>##       apiVersion cytoscapeVersion 
##             &quot;v1&quot;         &quot;3.10.0&quot;</code></pre>
<hr />
</div>
<div id="create-an-enrichment-map-1" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> Create an Enrichment map<a href="create-enrichment-map-from-r-with-gsea-results.html#create-an-enrichment-map-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you are running R from within a docker you need to first upload your datafiles to Cytoscape before you can create your enrichment map</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#if using docker we need to replace all the the paths to the host path</span></span>
<span id="cb89-2"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(is_docker) {</span>
<span id="cb89-3"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-3" aria-hidden="true" tabindex="-1"></a>  upload_em_file <span class="ot">&lt;-</span> <span class="cf">function</span>(localPath) {</span>
<span id="cb89-4"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-4" aria-hidden="true" tabindex="-1"></a>    bname <span class="ot">&lt;-</span> <span class="fu">basename</span>(localPath)</span>
<span id="cb89-5"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-5" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">POST</span>(</span>
<span id="cb89-6"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">url =</span> </span>
<span id="cb89-7"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&#39;http://host.docker.internal:1234/enrichmentmap/textfileupload?fileName=&#39;</span>, </span>
<span id="cb89-8"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-8" aria-hidden="true" tabindex="-1"></a>                  bname, <span class="at">sep=</span><span class="st">&quot;&quot;</span>),</span>
<span id="cb89-9"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">config =</span> <span class="fu">list</span>(),</span>
<span id="cb89-10"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">body =</span> <span class="fu">list</span>(<span class="at">file =</span> <span class="fu">upload_file</span>(localPath)),</span>
<span id="cb89-11"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">encode =</span> <span class="st">&quot;multipart&quot;</span>,</span>
<span id="cb89-12"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">handle =</span> <span class="cn">NULL</span></span>
<span id="cb89-13"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb89-14"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">content</span>(r,<span class="st">&quot;parsed&quot;</span>)<span class="sc">$</span>path</span>
<span id="cb89-15"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb89-16"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-17"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># &quot;upload&quot; the files to the host machine and replace each path </span></span>
<span id="cb89-18"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># with the host machine path</span></span>
<span id="cb89-19"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-19" aria-hidden="true" tabindex="-1"></a>  expression_file_fullpath <span class="ot">&lt;-</span> <span class="fu">upload_em_file</span>(expression_file_fullpath)</span>
<span id="cb89-20"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-20" aria-hidden="true" tabindex="-1"></a>  gmt_gsea_file <span class="ot">&lt;-</span> <span class="fu">upload_em_file</span>(gmt_gsea_file)</span>
<span id="cb89-21"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-21" aria-hidden="true" tabindex="-1"></a>  gsea_ranks_file <span class="ot">&lt;-</span> <span class="fu">upload_em_file</span>(gsea_ranks_file)</span>
<span id="cb89-22"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-22" aria-hidden="true" tabindex="-1"></a>  gsea_results_filename <span class="ot">&lt;-</span> <span class="fu">upload_em_file</span>(gsea_results_filename)</span>
<span id="cb89-23"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb89-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<hr />
</div>
<div id="create-an-enrichment-map---run-em-command-1" class="section level2 hasAnchor" number="8.8">
<h2><span class="header-section-number">8.8</span> Create an Enrichment map - run EM command<a href="create-enrichment-map-from-r-with-gsea-results.html#create-an-enrichment-map---run-em-command-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">#######################################</span></span>
<span id="cb90-2"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="co">#create EM</span></span>
<span id="cb90-3"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-3" aria-hidden="true" tabindex="-1"></a>current_network_name <span class="ot">&lt;-</span> <span class="fu">paste</span>(cur_model_name,pvalue_gsea_threshold,</span>
<span id="cb90-4"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-4" aria-hidden="true" tabindex="-1"></a>                              qvalue_gsea_threshold,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>)</span>
<span id="cb90-5"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-6" aria-hidden="true" tabindex="-1"></a>em_command <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">&#39;enrichmentmap build analysisType=&quot;gsea&quot; gmtFile=&#39;</span>,</span>
<span id="cb90-7"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-7" aria-hidden="true" tabindex="-1"></a>                                                              gmt_gsea_file,</span>
<span id="cb90-8"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;pvalue=&#39;</span>,pvalue_gsea_threshold, </span>
<span id="cb90-9"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-9" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;qvalue=&#39;</span>,qvalue_gsea_threshold,</span>
<span id="cb90-10"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;similaritycutoff=&#39;</span>,similarity_threshold,</span>
<span id="cb90-11"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-11" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;coefficients=&#39;</span>,similarity_metric,</span>
<span id="cb90-12"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-12" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;ranksDataset1=&#39;</span>, gsea_ranks_file,</span>
<span id="cb90-13"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-13" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;enrichmentsDataset1=&#39;</span>,gsea_results_filename, </span>
<span id="cb90-14"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-14" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;filterByExpressions=false&#39;</span>,</span>
<span id="cb90-15"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-15" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;expressionDataset1=&#39;</span>,expression_file_fullpath,</span>
<span id="cb90-16"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-16" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;gmtFile=&#39;</span>,gmt_gsea_file,</span>
<span id="cb90-17"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sep=</span><span class="st">&quot; &quot;</span>)</span>
<span id="cb90-18"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-19"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-19" aria-hidden="true" tabindex="-1"></a><span class="co">#enrichment map command will return the suid of newly created network.</span></span>
<span id="cb90-20"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-20" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">commandsGET</span>(em_command,<span class="at">base.url =</span> current_base)</span>
<span id="cb90-21"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-22"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-22" aria-hidden="true" tabindex="-1"></a>current_network_suid <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb90-23"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-23" aria-hidden="true" tabindex="-1"></a><span class="co">#enrichment map command will return the suid of newly created network </span></span>
<span id="cb90-24"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-24" aria-hidden="true" tabindex="-1"></a><span class="co"># unless it Failed.  If it failed it will contain the word failed</span></span>
<span id="cb90-25"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-25" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">grepl</span>(<span class="at">pattern=</span><span class="st">&quot;Failed&quot;</span>, response)){</span>
<span id="cb90-26"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(response)</span>
<span id="cb90-27"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-27" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb90-28"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-28" aria-hidden="true" tabindex="-1"></a>  current_network_suid <span class="ot">&lt;-</span> response</span>
<span id="cb90-29"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-30"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-31"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-31" aria-hidden="true" tabindex="-1"></a><span class="co">#check to see if the network name is unique</span></span>
<span id="cb90-32"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-32" aria-hidden="true" tabindex="-1"></a>current_names <span class="ot">&lt;-</span> <span class="fu">getNetworkList</span>(<span class="at">base.url =</span> current_base)</span>
<span id="cb90-33"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-33" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(current_network_name <span class="sc">%in%</span> current_names){</span>
<span id="cb90-34"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#if the name already exists in the network names then put the SUID in front</span></span>
<span id="cb90-35"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># of the name (this does not work if you put the suid at the end of the name)</span></span>
<span id="cb90-36"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-36" aria-hidden="true" tabindex="-1"></a>  current_network_name <span class="ot">&lt;-</span> <span class="fu">paste</span>(current_network_suid,</span>
<span id="cb90-37"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-37" aria-hidden="true" tabindex="-1"></a>                                current_network_name,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>)</span>
<span id="cb90-38"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-39"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-39" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">renameNetwork</span>(<span class="at">title=</span>current_network_name, </span>
<span id="cb90-40"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-40" aria-hidden="true" tabindex="-1"></a>                       <span class="at">network =</span> <span class="fu">as.numeric</span>(current_network_suid),</span>
<span id="cb90-41"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb90-41" aria-hidden="true" tabindex="-1"></a>                       <span class="at">base.url =</span> current_base)</span></code></pre></div>
</div>
<div id="get-a-screen-shot-of-the-initial-network.-1" class="section level2 hasAnchor" number="8.9">
<h2><span class="header-section-number">8.9</span> Get a screen shot of the initial network.<a href="create-enrichment-map-from-r-with-gsea-results.html#get-a-screen-shot-of-the-initial-network.-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#you can only output the file if it isn&#39;t on docker</span></span>
<span id="cb91-2"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co">#on docker is put it into the user&#39;s home directory with docker </span></span>
<span id="cb91-3"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># has not access to</span></span>
<span id="cb91-4"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span>is_docker){</span>
<span id="cb91-5"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-5" aria-hidden="true" tabindex="-1"></a>  output_network_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">getwd</span>(),<span class="st">&quot;initial_screenshot_network.png&quot;</span>)</span>
<span id="cb91-6"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-6" aria-hidden="true" tabindex="-1"></a>  output_network_file_current <span class="ot">&lt;-</span> output_network_file</span>
<span id="cb91-7"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitContent</span>()</span>
<span id="cb91-9"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-10"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">file.exists</span>(output_network_file)){</span>
<span id="cb91-11"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#cytoscape hangs waiting for user response if file already exists.</span></span>
<span id="cb91-12"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove it first</span></span>
<span id="cb91-13"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-13" aria-hidden="true" tabindex="-1"></a>    response <span class="ot">&lt;-</span> <span class="fu">file.remove</span>(output_network_file)</span>
<span id="cb91-14"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-14" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb91-15"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-16"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-16" aria-hidden="true" tabindex="-1"></a>  response <span class="ot">&lt;-</span> <span class="fu">exportImage</span>(output_network_file, <span class="at">type =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb91-17"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">base.url =</span> current_base)</span>
<span id="cb91-18"><a href="create-enrichment-map-from-r-with-gsea-results.html#cb91-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="create-enrichment-map-from-r-with-gprofiler-results.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/risserlin/CBW_pathways_workshop_R_notebooks/edit/main/07-Create_EM_from_GSEA_results.Rmd",
"text": "Suggest an edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["cbw_workshop_notebooks.pdf", "https://github.com/risserlin/CBW_pathways_workshop_R_notebooks/raw/main/07-Create_EM_from_GSEA_results.Rmd"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
