[{"path":"index.html","id":"index","chapter":"1 Index","heading":"1 Index","text":"","code":""},{"path":"intro.html","id":"intro","chapter":"2 CBW Workshop example R Notebooks","heading":"2 CBW Workshop example R Notebooks","text":"want run pathways network analysis R instead everything mannually demonstrated workshop?Everything (almost!) discussed lectures practicals can done computationally R.using bookdown package (Xie 2023) Workshop R Notebooks book, built top R Markdown knitr (Xie 2015).","code":""},{"path":"setup.html","id":"setup","chapter":"3 Setup","heading":"3 Setup","text":"many open source projects, R constantly evolving language regular updates. major release year patch releases year. Often scripts packages work one release next (ignoring pesky warnings package compiled previous version R common) exceptions. newer packages work latest version R sometimes choice upgrading using new package might present . Often, amount packages work need upgrade realized process begun. docker demonstrates valuable features. can create new instance based latest release R needed packages without change current settings.order use notebooks supplied need R installed computer list packages. notebook set check required packages install missing base level need just R installed.many different ways can use setup R. simply installing R can use directly highly recommended also install use RStudio Integrate development environment (IDE) R. just download RStudio use . requires installation R.don’t need install R RStudio though. can also use R RStudio docker. highly recommend using docker instead","code":""},{"path":"setup.html","id":"docker-optional","chapter":"3 Setup","heading":"3.1 Docker [Optional]","text":"Changing versions environments continuing struggle bioinformatics pipelines computational pipelines general. analysis written performed year ago might run produce results run today. Recording package system versions updating certain packages rarely work long run.One best solutions reproducibility issues containing workflow pipeline coding environment everything operating system, programs packages defined can built set given instructions. many systems offer type control including:Docker.Singularity“container standard unit software packages code dependencies application runs quickly reliably one computing environment another.” (“Container?” n.d.)containers great Bioiformatics?allows create environments run bioinformatis pipelines.create consistent environment use pipelines.test modifications pipeline without disrupting current set .Coming back analysis years later need install older versions packages programming languages. Simply create container re-run.","code":""},{"path":"setup.html","id":"install-docker","chapter":"3 Setup","heading":"3.2 Install Docker","text":"Download install docker desktop.Follow slightly different instructions Windows MacOS/Linux","code":""},{"path":"setup.html","id":"windows","chapter":"3 Setup","heading":"3.2.1 Windows","text":"might prompt install additional updates (example - https://docs.Microsoft.com/en-us/windows/wsl/install-win10#step-4---download--linux-kernel-update-package) require multiple restarts system docker.launch docker desktop app.Open windows Power shellnavigate directory system plan keeping code. example: C:\\USERS\\risserlin\\cbw_workshop_codeRun following command: (difference windows command way current directory written. ${PWD} instead \"$(pwd)\")Windows defender firewall might pop warning. Click Allow access.docker desktop see containers running easily manage .\n\n","code":"docker run -e PASSWORD=changeit --rm \\\n  -v ${PWD}:/home/rstudio/projects -p 8787:8787 \\\n  risserlin/workshop_base_image"},{"path":"setup.html","id":"macos-linux","chapter":"3 Setup","heading":"3.2.2 MacOS / Linux","text":"Open Terminalnavigate directory system plan keeping code. example: /Users/risserlin/bcb420_codeRun following command: (difference windows command way current directory written. ${PWD} instead \"$(pwd)\")","code":"docker run -e PASSWORD=changeit --rm \\\n  -v \"$(pwd)\":/home/rstudio/projects -p 8787:8787 \\\n  --add-host \"localhost:My.IP.address\"\n  risserlin/workshop_base_image"},{"path":"methods.html","id":"methods","chapter":"4 Methods","heading":"4 Methods","text":"describe methods chapter.Math can added body using usual syntax like ","code":""},{"path":"methods.html","id":"math-example","chapter":"4 Methods","heading":"4.1 math example","text":"\\(p\\) unknown expected around 1/3. Standard error approximated\\[\nSE = \\sqrt(\\frac{p(1-p)}{n}) \\approx \\sqrt{\\frac{1/3 (1 - 1/3)} {300}} = 0.027\n\\]can also use math footnotes like this1.approximate standard error 0.0272","code":""},{"path":"applications.html","id":"applications","chapter":"5 Applications","heading":"5 Applications","text":"significant applications demonstrated chapter.","code":""},{"path":"applications.html","id":"example-one","chapter":"5 Applications","heading":"5.1 Example one","text":"","code":""},{"path":"applications.html","id":"example-two","chapter":"5 Applications","heading":"5.2 Example two","text":"","code":""},{"path":"create-gmt-file-from-ensembl.html","id":"create-gmt-file-from-ensembl","chapter":"6 Create GMT file from Ensembl","heading":"6 Create GMT file from Ensembl","text":"https://download.baderlab.org/EM_Genesets/ updated resource geneset files GO, Reactome, WikiPathways, Pathbank, NetPath, HumanCyc, IOB, … many others can used https://biit.cs.ut.ee/gprofiler/gost https://www.gsea-msigdb.org/gsea/index.jsp many enrichment tools support gmt format.Unfortunately genesets supplied :https://download.baderlab.org/EM_Genesets/current_release/Human/https://download.baderlab.org/EM_Genesets/current_release/Mouse/https://download.baderlab.org/EM_Genesets/current_release/Rat/https://download.baderlab.org/EM_Genesets/current_release/Woodchuck/working different species need generate gmt file. best way ensembl. Ensembl doesn’t annotations pathway databases listed annotations species GO.","code":"\nworking_dir <- \"./genereated_data\"\nspecies <- \"horse\"\nensembl_dataset <- \"ecaballus_gene_ensembl\"\n#use library\n#make sure biocManager is installed\ntryCatch(expr = { library(\"BiocManager\")}, \n         error = function(e) { \n           install.packages(\"BiocManager\")}, \n         finally = library(\"BiocManager\"))\n\n\ntryCatch(expr = { library(\"biomaRt\")}, \n         error = function(e) { \n           BiocManager::install(\"biomaRt\")}, \n         finally = library(\"biomaRt\"))"},{"path":"create-gmt-file-from-ensembl.html","id":"load-libraries","chapter":"6 Create GMT file from Ensembl","heading":"6.1 Load Libraries","text":"Create set directory store generatd results","code":"\nif(!dir.exists(working_dir)){\n  dir.create(working_dir)\n}"},{"path":"create-gmt-file-from-ensembl.html","id":"set-up-biomart-connection","chapter":"6 Create GMT file from Ensembl","heading":"6.2 Set up Biomart connection","text":"Connect BiomartFigure dataset want use - species might datasets choose . datasets common namesa associated . example, search ‘yeast’ nothing returned look Saccharomyces cerevisiae able find .know ensembl dataset want use can specify parameters grab table dataset species interested .","code":"\nensembl <- useMart(\"ensembl\",host = \"https://asia.ensembl.org\")\nall_datasets <- listDatasets(ensembl)\n\n#get all the datasets that match our species definition\nall_datasets[grep(all_datasets$description,\n                  pattern=species,\n                  ignore.case = TRUE),]##                         dataset                                 description\n## 60       ecaballus_gene_ensembl                     Horse genes (EquCab3.0)\n## 76          hcomes_gene_ensembl  Tiger tail seahorse genes (H_comes_QL1_v1)\n## 164 rferrumequinum_gene_ensembl Greater horseshoe bat genes (mRhiFer1_v1.p)\n##            version\n## 60       EquCab3.0\n## 76  H_comes_QL1_v1\n## 164  mRhiFer1_v1.p\nensembl_dataset <- ensembl_dataset\nensembl = useDataset(ensembl_dataset,mart=ensembl)"},{"path":"create-gmt-file-from-ensembl.html","id":"get-species-go-annotations","chapter":"6 Create GMT file from Ensembl","heading":"6.3 Get species GO annotations","text":"Get GO annotations speciesThere two identifiers can choose table\n* external_symbols\n* ensembl_idsEach stored list dataframe. order convert right format gmt file need convert list string tab delimited strings. (unfortunately streaightforward way write dataframe’s column lists.)","code":"\ngo_annotation <- getBM(attributes = c(\"external_gene_name\",\n                                      \"ensembl_gene_id\",\n                                      \"ensembl_transcript_id\",\n                                      \"go_id\", \n                                      \"name_1006\", \n                                      \"namespace_1003\",\n                                      \"go_linkage_type\"), \n                       filters=list(biotype='protein_coding'), mart=ensembl);\n\n#get just the go biological process subset\n#####\n# Get rid of this line if you want to include all of go and not just biological process\n#####\ngo_annotation_bp <- go_annotation[which(go_annotation$namespace_1003 == \"biological_process\"),]\n\n#compute the unique pathway sets\ngo_pathway_sets <- aggregate(go_annotation_bp[,1:5],\n                             by = list(go_annotation_bp$go_id),\n                             FUN = function(x){list(unique(x))})\n\n#unlist the go descriptions\ngo_pathway_sets$name_1006 <- apply(go_pathway_sets,1,FUN=function(x){\n   paste(gsub(unlist(x$name_1006),pattern= \"\\\"\",replacement = \"\"),collapse = \"\")})\ngo_pathway_sets[1:3,\"external_gene_name\"]## [[1]]\n## [1] \"MEF2A\"    \"SLC25A36\" \"OPA1\"     \"MGME1\"    \"SLC25A33\" \"TYMP\"     \"AKT3\"    \n## [8] \"PIF1\"    \n## \n## [[2]]\n## [1] \"GNRH1\" \"GNRH2\" \"LIN9\" \n## \n## [[3]]\n## [1] \"ERCC6\" \"ERCC8\" \"LIG4\"  \"APLF\"  \"APTX\"  \"XRCC1\" \"SIRT1\" \"XNDC1\"\ngo_pathway_sets[1:3,\"ensembl_gene_id\"]## [[1]]\n## [1] \"ENSECAG00000011593\" \"ENSECAG00000010094\" \"ENSECAG00000024248\"\n## [4] \"ENSECAG00000012675\" \"ENSECAG00000016862\" \"ENSECAG00000001072\"\n## [7] \"ENSECAG00000019722\" \"ENSECAG00000005316\"\n## \n## [[2]]\n## [1] \"ENSECAG00000010664\" \"ENSECAG00000039220\" \"ENSECAG00000014325\"\n## \n## [[3]]\n## [1] \"ENSECAG00000014160\" \"ENSECAG00000018335\" \"ENSECAG00000003257\"\n## [4] \"ENSECAG00000013246\" \"ENSECAG00000012674\" \"ENSECAG00000014127\"\n## [7] \"ENSECAG00000013909\" \"ENSECAG00000042118\""},{"path":"create-gmt-file-from-ensembl.html","id":"format-results-into-gmt-file","chapter":"6 Create GMT file from Ensembl","heading":"6.4 Format results into GMT file","text":"Convert column lists tab delimited string gene namesConvert column lists tab delimited string gene namesThe format GMT file described https://software.broadinstitute.org/cancer/software/gsea/wiki/index.php/Data_formats#GMT:Gene_Matrix_Transposed_file_format.28.2A.gmt.29 consists rows followingNameDescriptiontab delimited list genes part genesetWrite gmt file genenamesWrite gmt file ensembl ids","code":"\ngo_pathway_sets$collapsed_genenames <- apply(go_pathway_sets,1,FUN=function(x){\n   paste(gsub(unlist(x$external_gene_name),pattern= \"\\\"\",replacement = \"\"),collapse = \"\\t\")\n})\ngo_pathway_sets$collapsed_ensemblids <- apply(go_pathway_sets,1,FUN=function(x){\n   paste(gsub(unlist(x$ensembl_gene_id),pattern= \"\\\"\",replacement = \"\"),collapse = \"\\t\")\n})\ngmt_file_genenames <- go_pathway_sets[,c(\"Group.1\",\"name_1006\",\"collapsed_genenames\")]\ncolnames(gmt_file_genenames)[1:2] <- c(\"name\",\"description\") \n\ngmt_genenames_filename <- file.path(working_dir, paste(species,ensembl_dataset,\"GO_genesets_GN.gmt\",sep = \"_\"))\n\nwrite.table(x = gmt_file_genenames,file = gmt_genenames_filename,\n            quote = FALSE,sep = \"\\t\",row.names = FALSE,\n            col.names=TRUE)\ngmt_file_ensemblids <- go_pathway_sets[,c(\"Group.1\",\"name_1006\",\"collapsed_ensemblids\")]\ncolnames(gmt_file_ensemblids)[1:2] <- c(\"name\",\"description\") \n\ngmt_ensemblids_filename <- file.path(working_dir, paste(species,ensembl_dataset,\"GO_genesets_esemblids.gmt\",sep = \"_\"))\n\nwrite.table(x = gmt_file_ensemblids,file = gmt_ensemblids_filename,\n            quote = FALSE,sep = \"\\t\",row.names = FALSE,\n            col.names=TRUE)"}]
